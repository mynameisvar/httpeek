<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>httpeek UI</title>
    <style>
        body { font-family: sans-serif; margin: 20px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ccc; padding: 5px; font-size: 12px; }
        tr:hover { background: #f2f2f2; cursor: pointer; }
        #details { margin-top: 20px; padding: 10px; border: 1px solid #aaa; }
        pre { white-space: pre-wrap; word-wrap: break-word; }
    </style>
</head>
<body>
<h1>httpeek â€“ Captured Requests</h1>
<table id="entries">
    <thead>
    <tr><th>ID</th><th>Method</th><th>URL</th><th>Status</th></tr>
    </thead>
    <tbody></tbody>
</table>

<div id="details">
    <h3>Details</h3>
    <pre id="detailText">Click on a row to see details</pre>
</div>

<script>
    const evtSource = new EventSource("/events");

    evtSource.addEventListener("entry", function(e) {
        const entry = JSON.parse(e.data);
        addRow(entry);
    });

    function addRow(e) {
        const tbody = document.querySelector("#entries tbody");
        const row = document.createElement("tr");
        row.innerHTML =
            "<td>"+(e.id||'')+"</td>"+
            "<td>"+(e.method||'')+"</td>"+
            "<td>"+(e.url||'')+"</td>"+
            "<td>"+(e.status||'')+"</td>";
        row.onclick = () => {
            document.getElementById("detailText").innerText =
                "REQUEST:\n" + JSON.stringify(e.request, null, 2) +
                "\n\nRESPONSE:\n" + JSON.stringify(e.response, null, 2);
        };
        tbody.prepend(row);
    }
</script>
</body>
</html>
